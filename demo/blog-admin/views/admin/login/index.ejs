<!DOCTYPE html>
<!-- saved from url=(0043)http://vip-admin.com/admin/login/index.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>登录</title>
	<link rel="stylesheet" href="../../frame/layui/css/layui.css">
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="icon" href="image/code.png">
	<link id="layuicss-skinlayercss" rel="stylesheet" href="../../frame/layui/css/modules/layer/default/layer.css" media="all"></head>
    <style>
        body{
            overflow: hidden;
        }
    </style>
<body class="login-body">

<canvas id="bgCanvas" ></canvas>

<div class="login-box">
    <form class="layui-form layui-form-pane" id="from">
        <div class="layui-form-item">
            <h3>blog 后台管理系统&nbsp;<span class="version">0.0.1</span></h3>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">账号：</label>

            <div class="layui-input-inline">
                <input type="text" name="userName" class="layui-input" lay-verify="account" placeholder="账号" autocomplete="on" maxlength="20">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">密码：</label>

            <div class="layui-input-inline">
                <input type="password" name="password" class="layui-input" lay-verify="password" placeholder="密码" maxlength="20">
            </div>
        </div>
		
        <div class="layui-form-item">
            <label class="layui-form-label">验证码：</label>
			<div class="layui-input-inline" id="v_container">
				<input type="text" name="verify" class="layui-input" lay-verify="verify" placeholder="验证码" maxlength="4">
			</div>
        </div>
		
        <div class="layui-form-item">
            <button type="reset" class="layui-btn btn-reset layui-btn-danger">重置</button>
            <button type="button" class="layui-btn btn-submit" id="submit" lay-submit="" lay-filter="sub">立即登录</button>
        </div>
    </form>
</div>

<script type="text/javascript" src="../../frame/layui/layui.js"></script>
<script type="text/javascript" src="../../js/canvasBg.js"></script>
<script type="text/javascript" src="../../js/gVerify.js"></script>
<script type="text/javascript" src="../../js/md5.js"></script>
<script type="text/javascript">

   

    /* 解决登录页被嵌套问题js */
    var _topWin = window;
    while (_topWin != _topWin.parent.window) {
        _topWin = _topWin.parent.window;
    }
    if (window != _topWin)_topWin.document.location.href = "/aliadmin/login";

    layui.use(['jquery','form', 'layer'], function () {
        var $ = layui.jquery,form = layui.form(),layer = layui.layer,$ = layui.jquery;

        //验证码生成
        var verifyCode = new GVerify({
                id : "v_container",
                width:'100',
                height: '38'
        });

        // 登录表单验证
        form.verify({
            account: function (value) {
                if (value == "") {
                    return "请输入用户名";
                }
            },
            password: function (value) {
                if (value == "") {
                    return "请输入密码";
                }
            },
            verify: function (value) {
                if (value == "") {
                    return "请输入验证码";
                }else if( value != verifyCode.options.code ){
                    return '验证码输入错误';
                }
            }
        });

        // 登录提交监听
        form.on('submit(sub)', function (data) {
            var hash = hex_md5(data.field.password);
            data.field.password = hex_md5(hash);
            $.post("/aliadmin/login",data.field,function(res){
                if(res.type=='success'){
                    layer.msg(res.content,{time:1800});
                    setTimeout(function(){
                        location.href = "/aliadmin";
                    },500)
                }else{
                    layer.msg(res.content,{time:1000});
                    $('[type="password"]').val('');
                }
            });
            return false;
        })
    })

</script>

</body></html>